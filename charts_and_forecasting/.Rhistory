ggplot(days, y_world, main="Spread of coronavirus around the world", xlab='Day', ylab='Confirmed cases')
ggplot(aes(x=days, y=y_world), main="Spread of coronavirus around the world", xlab='Day', ylab='Confirmed cases')
ggplot(aes=(x=days, y=y_world), main="Spread of coronavirus around the world", xlab='Day', ylab='Confirmed cases')
data_df$days = days
data_df$world = world
data_df['days'] = days
data_df['world'] = world
plot(days,y_world, main="Spread of coronavirus around the world", xlab='Day', ylab='Confirmed cases')
lines(days,y_world)
lines(days,y_chine)
lines(days,y_china)
lines(days,y_china, col='red')
lines(days,y_china, col='red', pch=12)
lines(days,y_china, col='red', pch=16)
plot(days,y_world, main="Spread of coronavirus around the world", xlab='Day', ylab='Confirmed cases', type='none')
lines(days,y_world, col='blue', pch=12)
lines(days,y_china, col='red', pch=16)
lines(days,y_italy, col='green', pch=16)
lines(days,y_spain,col='orange', pch=16)
lines(days,y_brazil,col='black', pch=16)
grouped_df
grouped_df[,]
grouped_df[,'Brazil']
grouped_df[,c('Brazil','date','day','China','World','Italy','Spain')]
grouped_df[,c('date','day','World','China','Italy','Spain','Brazil')]
grouped_df[,-c('date','day','World','China','Italy','Spain','Brazil')]
grouped_df[,c('date','day','World','China','Italy','Spain','Brazil')]
subset(grouped_df, select = -c('date','day','World','China','Italy','Spain','Brazil'))
grouped_df[, !names(grouped_df) %in% c('date','day','World','China','Italy','Spain','Brazil'), drop = FALSE]
other_group <- grouped_df[, !names(grouped_df) %in% c('date','day','World','China','Italy','Spain','Brazil'), drop = FALSE]
View(other_group)
rowsum(other_group)
colsum(other_group)
rowSums(other_group)
other_group <- rowSums(grouped_df[, !names(grouped_df) %in% c('date','day','World','China','Italy','Spain','Brazil'), drop = FALSE])
other_group
y_other <- other_group[(length(other_group)-length(days)+1):length(other_group)]
lines(days,y_other, col='red', type = 'o')
lines(days,y_world, col='blue', pch=12, lwd=c('o'))
lines(days,y_world, col='blue', pch=12, lwd=c(4))
lines(days,y_world, col='blue', pch=12, lwd=4)
lines(days,y_china, col='red', pch=16, lwd=2)
lines(days,y_italy, col='green', lwd=5)
plot(days,y_world, main="Spread of coronavirus around the world", xlab='Day', ylab='Confirmed cases', type='none')
lines(days,y_world, col='blue', lwd=4)
lines(days,y_china, col='red', lwd=4)
lines(days,y_italy, col='green', lwd=4)
lines(days,y_spain,col='orange', lwd=4)
lines(days,y_brazil,col='black', lwd=4)
lines(days,y_other, col='red', lwd=4)
plot(days,y_world, main="Spread of coronavirus around the world", xlab='Day', ylab='Confirmed cases', type='none')
lines(days,y_world, col='blue', lwd=4, pch=0)
lines(days,y_china, col='red', lwd=4, pch=1)
lines(days,y_italy, col='green', lwd=4, pch=2)
lines(days,y_spain,col='orange', lwd=4, pch=3)
lines(days,y_brazil,col='black', lwd=4, pch=4)
lines(days,y_other, col='red', lwd=4, pch=5)
points(days,y_world, col='blue', lwd=4, pch=0)
plot(days,y_world, main="Spread of coronavirus around the world", xlab='Day', ylab='Confirmed cases', type='none')
points(days,y_world, col='blue', lwd=2, pch=0)
points(days,y_china, col='red', lwd=2, pch=1)
points(days,y_italy, col='green', lwd=2, pch=2)
points(days,y_spain,col='orange', lwd=2, pch=3)
points(days,y_brazil,col='black', lwd=2, pch=4)
points(days,y_other, col='red', lwd=2, pch=5)
tbl_header <- c('day','world','china','italy','spain','brazil','other')
data <- data.frame(days, y_world, y_china, y_italy, y_spain, y_brazil, y_other)
data
dimnames(data)
dimnames(data) <- tbl_header
names(data)
names(data) <- tbl_header
View(df)
View(data)
ggplot(data, aes=(x=day,y=world)) +
theme_bw()
ggplot(data, aes=(x=day,fill=world)) +
theme_bw()
ggplot(data, aes(x=day)) +
theme_bw() +
geom_histogram(aes(y=world), alpha=0.7,binwidth=.25,col="black")
ggplot(data, aes(x=day))
ggplot(data, aes(x = day,y = world))
ggplot(data, aes(x = day,y = world)) +
geom_line(stat='identity')
ggplot(data) +
geom_line(stat='identity', aes(x=day,y=world))
ggplot(data) +
geom_line(stat='identity', aes(x=day,y=world))
ggplot(data, aes(x=day)) +
geom_line(stat='identity', aes(y=world)) +
geom_line(stat='identity', aes(y=china))
ggplot(data, aes(x=day)) +
geom_line(stat='identity', aes(y=world)) +
geom_line(stat='identity', aes(y=china)) +
geom_line(stat='identity', aes(y=italy)) +
geom_line(stat='identity', aes(y=spain)) +
geom_line(stat='identity', aes(y=brazil)) +
geom_line(stat='identity', aes(y=other))
ggplot(data, aes(x=day)) +
geom_histogram(aes(y=world))
ggplot(data, aes(x=day)) +
geom_histogram(aes(y=world),alpha=0.7,binwidth=.25)
ggplot(data, aes(x=day)) +
geom_histogram(aes(y=world))
ggplot(data, aes(x=day)) +
geom_line(stat='identity', aes(y=world)) +
geom_line(stat='identity', aes(y=china)) +
geom_line(stat='identity', aes(y=italy)) +
geom_line(stat='identity', aes(y=spain)) +
geom_line(stat='identity', aes(y=brazil)) +
geom_line(stat='identity', aes(y=other))
ggplot(data, aes(x=day)) +
geom_line(stat='identity', aes(y=world)) +
geom_line(stat='identity', aes(y=china)) +
geom_line(stat='identity', aes(y=italy)) +
geom_line(stat='identity', aes(y=spain)) +
geom_line(stat='identity', aes(y=brazil)) +
geom_line(stat='identity', aes(y=other))
ggplot(data, aes(x=day)) +
geom_line(stat='identity', aes(y=world)) +
geom_line(stat='identity', aes(y=china)) +
geom_line(stat='identity', aes(y=italy)) +
geom_line(stat='identity', aes(y=spain)) +
geom_line(stat='identity', aes(y=brazil)) +
geom_line(stat='identity', aes(y=other)) +
scale_color_brewer()
scale_fill_manual(breaks=c("world",'china','italy','spain','brazil','other'), values=c('red', 'blue','green','yellow','black','orange'))
ggplot(data, aes(x=day)) +
geom_line(stat='identity', aes(y=world)) +
geom_line(stat='identity', aes(y=china)) +
geom_line(stat='identity', aes(y=italy)) +
geom_line(stat='identity', aes(y=spain)) +
geom_line(stat='identity', aes(y=brazil)) +
geom_line(stat='identity', aes(y=other)) +
scale_fill_manual(breaks=c("world",'china','italy','spain','brazil','other'), values=c('red', 'blue','green','yellow','black','orange'))
ggplot(data, aes(x=day)) +
geom_line(stat='identity', aes(y=world)) +
geom_line(stat='identity', aes(y=china)) +
geom_line(stat='identity', aes(y=italy)) +
geom_line(stat='identity', aes(y=spain)) +
geom_line(stat='identity', aes(y=brazil)) +
geom_line(stat='identity', aes(y=other)) +
scale_color_manual(values=c('darkred','steelblue'))
ggplot(data, aes(x=day)) +
geom_line(stat='identity', aes(y=world)) +
geom_line(stat='identity', aes(y=china)) +
geom_line(stat='identity', aes(y=italy)) +
geom_line(stat='identity', aes(y=spain)) +
geom_line(stat='identity', aes(y=brazil)) +
geom_line(stat='identity', aes(y=other)) +
scale_color_manual(values=c('darkred','steelblue','red','blue','black','green'))
ggplot(data, aes(x=day)) +
geom_line(stat='identity', aes(y=world)) +
geom_line(stat='identity', aes(y=china),col='red') +
geom_line(stat='identity', aes(y=italy),col='green') +
geom_line(stat='identity', aes(y=spain),col='yellow') +
geom_line(stat='identity', aes(y=brazil),col='blue') +
geom_line(stat='identity', aes(y=other),col='brown')
ggplot(data, aes(x=day)) +
geom_point(stat='identity', aes(y=world)) +
geom_line(stat='identity', aes(y=china),col='red') +
geom_line(stat='identity', aes(y=italy),col='green') +
geom_line(stat='identity', aes(y=spain),col='yellow') +
geom_line(stat='identity', aes(y=brazil),col='blue') +
geom_line(stat='identity', aes(y=other),col='brown')
ggplot(data, aes(x=day)) +
geom_point(stat='identity', aes(y=world)) +
geom_point(stat='identity', aes(y=china),col='red', lwd=2) +
geom_point(stat='identity', aes(y=italy),col='green', lwd=3) +
geom_point(stat='identity', aes(y=spain),col='yellow', lwd=4) +
geom_point(stat='identity', aes(y=brazil),col='blue', lwd=5) +
geom_point(stat='identity', aes(y=other),col='brown', lwd=6)
ggplot(data, aes(x=day)) +
geom_point(stat='identity', aes(y=world)) +
geom_point(stat='identity', aes(y=china),col='red', pch=2)
ggplot(data, aes(x=day)) +
geom_point(stat='identity', aes(y=world)) +
geom_point(stat='identity', aes(y=china),col='red', pch=2) +
geom_point(stat='identity', aes(y=italy),col='green', pch=3) +
geom_point(stat='identity', aes(y=spain),col='yellow', pch=4) +
geom_point(stat='identity', aes(y=brazil),col='blue', pch=5) +
geom_point(stat='identity', aes(y=other),col='brown', pch=6)
ggplot(data, aes(x=day)) +
geom_point(stat='identity', aes(y=world)) +
geom_point(stat='identity', aes(y=china),col='red', pch=2) +
geom_point(stat='identity', aes(y=italy),col='green', pch=3) +
geom_point(stat='identity', aes(y=spain),col='yellow', pch=4) +
geom_point(stat='identity', aes(y=brazil),col='blue', pch=5) +
geom_point(stat='identity', aes(y=other),col='brown', pch=6) +
scale_fill_manual(name='Região',
breaks=c('world','china','italy','spain','brazil','other'),
labels=c('Mundo','China','Itália','Espanha','Brasil','Outros'))
ggplot(data, aes(x=day)) +
geom_point(stat='identity', aes(y=world)) +
geom_point(stat='identity', aes(y=china),col='red', pch=2) +
geom_point(stat='identity', aes(y=italy),col='green', pch=3) +
geom_point(stat='identity', aes(y=spain),col='yellow', pch=4) +
geom_point(stat='identity', aes(y=brazil),col='blue', pch=5) +
geom_point(stat='identity', aes(y=other),col='brown', pch=6) +
scale_fill_discrete(name='Região',
breaks=c('world','china','italy','spain','brazil','other'),
labels=c('Mundo','China','Itália','Espanha','Brasil','Outros'))
ggplot(data, aes(x=day)) +
geom_point(stat='identity', aes(y=world)) +
geom_point(stat='identity', aes(y=china),col='red', pch=2) +
geom_point(stat='identity', aes(y=italy),col='green', pch=3) +
geom_point(stat='identity', aes(y=spain),col='yellow', pch=4) +
geom_point(stat='identity', aes(y=brazil),col='blue', pch=5) +
geom_point(stat='identity', aes(y=other),col='brown', pch=6) +
scale_shape_discrete(name='Região',
breaks=c('world','china','italy','spain','brazil','other'),
labels=c('Mundo','China','Itália','Espanha','Brasil','Outros'))
lot(data, aes(x=day)) +
geom_point(stat='identity', aes(y=world)) +
geom_point(stat='identity', aes(y=china),col='red', pch=2) +
geom_point(stat='identity', aes(y=italy),col='green', pch=3) +
geom_point(stat='identity', aes(y=spain),col='yellow', pch=4) +
geom_point(stat='identity', aes(y=brazil),col='blue', pch=5) +
geom_point(stat='identity', aes(y=other),col='brown', pch=6) +
scale_shape_discrete(name='Região',
breaks=c(world,china,italy,spain,brazil,other),
labels=c('Mundo','China','Itália','Espanha','Brasil','Outros'))
ggplot(data, aes(x=day)) +
geom_point(stat='identity', aes(y=world)) +
geom_point(stat='identity', aes(y=china),col='red', pch=2) +
geom_point(stat='identity', aes(y=italy),col='green', pch=3) +
geom_point(stat='identity', aes(y=spain),col='yellow', pch=4) +
geom_point(stat='identity', aes(y=brazil),col='blue', pch=5) +
geom_point(stat='identity', aes(y=other),col='brown', pch=6) +
scale_shape_discrete(name='Região',
breaks=c(world,china,italy,spain,brazil,other),
labels=c('Mundo','China','Itália','Espanha','Brasil','Outros'))
View(df)
grouped_df.t
t(grouped_df)
View(t(grouped_df))
tbl_header <- c('day','country', 'counts')
c(y_world,y_brazil)
c(y_world,y_china,y_italy,y_spain,y_brazil,y_other)
?rep
rep('world',80)
c(rep('world',80),rep('china',80),rep('italy',80),rep('spain',80),rep('brazil',80),rep('other',80))
c(rep(days,6))
df <- read.csv(file = 'forecasting/total_cases.csv', header=TRUE)
grouped_df <- df %>% group_by(date) %>% summarise_all(sum)
grouped_df[is.na(grouped_df)] <- 0.
grouped_df$day <- seq.int(nrow(grouped_df))
other_group <- rowSums(grouped_df[, !names(grouped_df) %in% c('date','day','World','China','Italy','Spain','Brazil'), drop = FALSE])
day <- c(1:80)
y_world <- grouped_df$World[(length(grouped_df$World)-length(days)+1):length(grouped_df$World)]
y_brazil <- grouped_df$Brazil[(length(grouped_df$Brazil)-length(days)+1):length(grouped_df$Brazil)]
y_china <- grouped_df$China[(length(grouped_df$China)-length(days)+1):length(grouped_df$China)]
y_italy <- grouped_df$Italy[(length(grouped_df$Italy)-length(days)+1):length(grouped_df$Italy)]
y_spain <- grouped_df$Spain[(length(grouped_df$Spain)-length(days)+1):length(grouped_df$Spain)]
y_other <- other_group[(length(other_group)-length(days)+1):length(other_group)]
days <- c(rep(day,6))
countries <- c(rep('world',80),rep('china',80),rep('italy',80),rep('spain',80),rep('brazil',80),rep('other',80))
counts <- c(y_world,y_china,y_italy,y_spain,y_brazil,y_other)
tbl_header <- c('day','country', 'counts')
data <- data.frame(days,countries,counts)
names(data) <- tbl_header
counts <- c(y_world,y_china,y_italy,y_spain,y_brazil,y_other)
y_world <- grouped_df$World[(length(grouped_df$World)-length(days)+1):length(grouped_df$World)]
y_brazil <- grouped_df$Brazil[(length(grouped_df$Brazil)-length(days)+1):length(grouped_df$Brazil)]
y_china <- grouped_df$China[(length(grouped_df$China)-length(days)+1):length(grouped_df$China)]
y_italy <- grouped_df$Italy[(length(grouped_df$Italy)-length(days)+1):length(grouped_df$Italy)]
y_spain <- grouped_df$Spain[(length(grouped_df$Spain)-length(days)+1):length(grouped_df$Spain)]
y_other <- other_group[(length(other_group)-length(days)+1):length(other_group)]
y_world <- grouped_df$World[(length(grouped_df$World)-length(days)+1):length(grouped_df$World)]
df <- read.csv(file = 'forecasting/total_cases.csv', header=TRUE)
grouped_df <- df %>% group_by(date) %>% summarise_all(sum)
grouped_df[is.na(grouped_df)] <- 0.
grouped_df$day <- seq.int(nrow(grouped_df))
other_group <- rowSums(grouped_df[, !names(grouped_df) %in% c('date','day','World','China','Italy','Spain','Brazil'), drop = FALSE])
days <- c(1:80)
y_world <- grouped_df$World[(length(grouped_df$World)-length(days)+1):length(grouped_df$World)]
y_brazil <- grouped_df$Brazil[(length(grouped_df$Brazil)-length(days)+1):length(grouped_df$Brazil)]
y_china <- grouped_df$China[(length(grouped_df$China)-length(days)+1):length(grouped_df$China)]
y_italy <- grouped_df$Italy[(length(grouped_df$Italy)-length(days)+1):length(grouped_df$Italy)]
y_spain <- grouped_df$Spain[(length(grouped_df$Spain)-length(days)+1):length(grouped_df$Spain)]
y_other <- other_group[(length(other_group)-length(days)+1):length(other_group)]
days <- c(rep(days,6))
countries <- c(rep('world',80),rep('china',80),rep('italy',80),rep('spain',80),rep('brazil',80),rep('other',80))
counts <- c(y_world,y_china,y_italy,y_spain,y_brazil,y_other)
tbl_header <- c('day','country', 'counts')
data <- data.frame(days,countries,counts)
names(data) <- tbl_header
View(data)
ggplot(data, aes(x=day,fill=countries)) +
geom_point(stat='identity', aes(y=counts))
ggplot(data, aes(x=day,y=counts,fill=countries)) +
geom_point(stat='identity')
ggplot(data, aes(x=day,y=counts,color=countries)) +
geom_point(stat='identity')
lm(log(count)~day),data=data)
lm(log(count)~day,data=data)
lm(log(counts)~day,data=data)
lm(log(1+counts)~day,data=data)
lm(-log(1+counts)~day,data=data)
lm(log(1-counts)~day,data=data)
lm(log(-log(1+counts))~day,data=data)
lm(log(log(1+counts))~day,data=data)
lm(log(1+counts)~day,data=data)
lm(log(-counts)~day,data=data)
lm(log(1-counts)~day,data=data)
lm(log(counts-1)~day,data=data)
lm(log(1+counts)~day,data=data)
model <- lm(log(1+counts)~day, data=data)
summary(model)
model <- lm(log(1+counts)~day, data=data %>% group_by(country))
summary(model)
data %>% group_by(country)
y <- lm(log(Italy)~day,data=grouped_df)
summary(y)
View(data)
model <- lm(log(1+counts)~day, data=data[data$country=='italy'])
model <- lm(log(1+counts)~day, data=data[,data$country=='italy'])
data[data$country=='italy']
data[data$country='italy']
data$country=='italy'
data[data$country=='italy']
data[,data$country=='italy']
data[data$country=='italy',]
model <- lm(log(1+counts)~day, data=data[data$country=='italy',])
summary(model)
time = 1
dt=c(0.5,0.1,0.01,0.001,0.001,0.00001,0.000001)
tdt=time+dt
Nt=time^2
Ntdt=tdt^2
(Ntdt-Nt)/2
ggplot(data, aes(x=day,y=counts,color=countries)) +
geom_line(stat='identity')
ggplot(data, aes(x=day,y=counts,color=countries)) +
geom_line(stat='identity')
f_world <- lm(log(World)~day,data=grouped_df)
f_china <- lm(log(China)~day,data=grouped_df)
f_italy <- lm(log(Italy)~day,data=grouped_df)
f_spain <- lm(log(Spain)~day,data=grouped_df)
f_brazil <- lm(log(Brazil)~day,data=grouped_df)
summary(f_world)
f_italy <- lm(log(Italy)~day,data=grouped_df[grouped_df$Italy>0])
f_world <- lm(log(World)~day,data=grouped_df)
f_china <- lm(log(China)~day,data=grouped_df)
f_italy <- lm(log(1+Italy)~day,data=grouped_df)
f_spain <- lm(log(1+Spain)~day,data=grouped_df)
f_brazil <- lm(log(1+Brazil)~day,data=grouped_df)
summary(f_world)
summary(f_china)
summary(f_china)
summary(f_italy)
summary(f_spain)
y_china <- lm(log(World)~(China+day), data=grouped_df)
summary(y_china)
y_china <- grouped_df$China[(length(grouped_df$China)-length(days)+1):length(grouped_df$China)]
f_china <- lm(log(World)~China+day,data=grouped_df)
exp(predict(y_china,list(China=grouped_df$Brazil,day=grouped_df$day)))
counts_brazil <- exp(predict(y_china,list(China=grouped_df$Brazil,day=grouped_df$day)))
plot(days,counts_brazil)
plot(grouped_df$day,counts_brazil)
plot(grouped_df$day,counts_brazil)
lines(grouped_df$day, counts_brazil)
plot(grouped_df$day,counts_brazil)
lines(grouped_df$day, counts_brazil, col='red')
f_world <- lm(log(World)~day,data=grouped_df)
f_china <- lm(log(World)~China+day,data=grouped_df)
f_italy <- lm(log(World)~Italy+day,data=grouped_df)
f_spain <- lm(log(World)~Spain+day,data=grouped_df)
f_brazil <- lm(log(World)~Brazil+day,data=grouped_df)
summary(f_world)
summary(f_china)
summary(f_italy)
summary(f_spain)
counts_brazil <- exp(predict(y_china,list(China=grouped_df$Brazil,day=grouped_df$day)))
counts_brazil2 <- exp(predict(y_italy,list(Italy=grouped_df$Brazil, day=grouped_df$day))
plot(grouped_df$day,counts_brazil2)
lines(grouped_df$day, counts_brazil2, col='red')
counts_brazil2 <- exp(predict(y_italy,list(Italy=grouped_df$Brazil, day=grouped_df$day)))
f_italy <- lm(log(World)~Italy+day,data=grouped_df)
setwd('~/workspace/dev/covid19-analysis/charts_and_forecasting/')
df <- read.csv(file = 'forecasting/total_cases.csv', header=TRUE)
grouped_df <- df %>% group_by(date) %>% summarise_all(sum)
grouped_df[is.na(grouped_df)] <- 0.
grouped_df$day <- seq.int(nrow(grouped_df))
other_group <- rowSums(grouped_df[, !names(grouped_df) %in% c('date','day','World','China','Italy','Spain','Brazil'), drop = FALSE])
days <- c(1:80)
y_world <- grouped_df$World[(length(grouped_df$World)-length(days)+1):length(grouped_df$World)]
y_brazil <- grouped_df$Brazil[(length(grouped_df$Brazil)-length(days)+1):length(grouped_df$Brazil)]
y_china <- grouped_df$China[(length(grouped_df$China)-length(days)+1):length(grouped_df$China)]
y_italy <- grouped_df$Italy[(length(grouped_df$Italy)-length(days)+1):length(grouped_df$Italy)]
y_spain <- grouped_df$Spain[(length(grouped_df$Spain)-length(days)+1):length(grouped_df$Spain)]
y_other <- other_group[(length(other_group)-length(days)+1):length(other_group)]
days <- c(rep(days,6))
countries <- c(rep('world',80),rep('china',80),rep('italy',80),rep('spain',80),rep('brazil',80),rep('other',80))
counts <- c(y_world,y_china,y_italy,y_spain,y_brazil,y_other)
tbl_header <- c('day','country', 'counts')
data <- data.frame(days,countries,counts)
names(data) <- tbl_header
ggplot(data, aes(x=day,y=counts,color=countries)) +
geom_line(stat='identity')
# global function spread
f_world <- lm(log(World)~day,data=grouped_df)
f_china <- lm(log(World)~China+day,data=grouped_df)
f_italy <- lm(log(World)~Italy+day,data=grouped_df)
f_spain <- lm(log(World)~Spain+day,data=grouped_df)
f_brazil <- lm(log(World)~Brazil+day,data=grouped_df)
summary(f_world)
summary(f_china)
summary(f_italy)
summary(f_spain)
counts_brazil <- exp(predict(f_china,list(China=grouped_df$Brazil,day=grouped_df$day)))
counts_brazil2 <- exp(predict(f_italy,list(Italy=grouped_df$Brazil, day=grouped_df$day)))
plot(grouped_df$day,counts_brazil)
lines(grouped_df$day, counts_brazil, col='red')
plot(grouped_df$day,counts_brazil2)
lines(grouped_df$day, counts_brazil2, col='red')
f_china <- lm(log(World)~log(China)+day,data=grouped_df)
# global function spread
f_world <- lm(log(World)~day,data=grouped_df)
f_china <- lm(log(World)~log(China)+day,data=grouped_df)
f_italy <- lm(log(World)~log(Italy)+day,data=grouped_df)
f_spain <- lm(log(World)~log(Spain)+day,data=grouped_df)
f_brazil <- lm(log(World)~log(Brazil)+day,data=grouped_df)
summary(f_world)
summary(f_china)
summary(f_italy)
summary(f_spain)
counts_brazil <- exp(predict(f_china,list(China=grouped_df$Brazil,day=grouped_df$day)))
counts_brazil2 <- exp(predict(f_italy,list(Italy=grouped_df$Brazil, day=grouped_df$day)))
plot(grouped_df$day,counts_brazil)
lines(grouped_df$day, counts_brazil, col='red')
plot(grouped_df$day,counts_brazil2)
lines(grouped_df$day, counts_brazil2, col='red')
plot(grouped_df$day,counts_brazil)
lines(grouped_df$day, counts_brazil, col='red')
plot(grouped_df$day,counts_brazil2)
lines(grouped_df$day, counts_brazil2, col='red')
counts_italy <- exp(predict(f_china,list(China=grouped_df$Italy, day=grouped_df$day)))
plot(grouped_df$day,counts_italy)
lines(grouped_df$day, counts_italy, col='red')
counts_italy <- exp(predict(f_world,list(days=c(90:100))))
counts_italy <- exp(predict(f_world,list(day=c(90:100))))
plot(grouped_df$day,counts_italy)
lines(grouped_df$day, counts_italy, col='red')
plot(c(90:100),counts_italy)
lines(c(90:100), counts_italy, col='red')
f_world <- lm(log(-World)~day,data=grouped_df)
summary(f_world)
counts_italy <- exp(predict(f_world,list(day=c(90:100))))
plot(c(90:100),counts_italy)
lines(c(90:100), counts_italy, col='red')
f_world <- lm(log-(log(-World))~day,data=grouped_df)
summary(f_world)
counts_italy <- exp(predict(f_world,list(day=c(90:100))))
plot(c(90:100),counts_italy)
lines(c(90:100), counts_italy, col='red')
days_of_spread = c(0:100)
counts_italy <- exp(predict(f_world,list(day=days_of_spread)))
plot(days_of_spread,counts_italy)
lines(days_of_spread, counts_italy, col='red')
f_china <- lm(log-(log(-China))~day,data=grouped_df)
f_china <- lm(log(-log(-China))~day,data=grouped_df)
require(dplyr)
require(ggplot2)
setwd('~/workspace/dev/covid19-analysis/charts_and_forecasting/')
df <- read.csv(file = 'forecasting/total_cases.csv', header=TRUE)
grouped_df <- df %>% group_by(date) %>% summarise_all(sum)
grouped_df[is.na(grouped_df)] <- 0.
grouped_df$day <- seq.int(nrow(grouped_df))
other_group <- rowSums(grouped_df[, !names(grouped_df) %in% c('date','day','World','China','Italy','Spain','Brazil'), drop = FALSE])
days <- c(1:80)
y_world <- grouped_df$World[(length(grouped_df$World)-length(days)+1):length(grouped_df$World)]
y_brazil <- grouped_df$Brazil[(length(grouped_df$Brazil)-length(days)+1):length(grouped_df$Brazil)]
y_china <- grouped_df$China[(length(grouped_df$China)-length(days)+1):length(grouped_df$China)]
y_italy <- grouped_df$Italy[(length(grouped_df$Italy)-length(days)+1):length(grouped_df$Italy)]
y_spain <- grouped_df$Spain[(length(grouped_df$Spain)-length(days)+1):length(grouped_df$Spain)]
y_other <- other_group[(length(other_group)-length(days)+1):length(other_group)]
days <- c(rep(days,6))
countries <- c(rep('world',80),rep('china',80),rep('italy',80),rep('spain',80),rep('brazil',80),rep('other',80))
counts <- c(y_world,y_china,y_italy,y_spain,y_brazil,y_other)
tbl_header <- c('day','country', 'counts')
data <- data.frame(days,countries,counts)
names(data) <- tbl_header
ggplot(data, aes(x=day,y=counts,color=countries)) +
geom_line(stat='identity')
f_world <- lm(log-(log(-World))~day,data=grouped_df)
f_china <- lm(log(-log(-China))~day,data=grouped_df)
f_world <- lm(log(-log(-World))~day,data=grouped_df)
f_world <- lm(-log(-log(World))~day,data=grouped_df)
f_world <- lm(-log(1-log(World))~day,data=grouped_df)
f_world <- lm(log(World)~day,data=grouped_df)
f_china <- lm(log(China)~day,data=grouped_df)
summary(f_world)
days_of_spread = c(0:100)
counts_italy <- exp(predict(f_world,list(day=days_of_spread)))
plot(days_of_spread,counts_italy)
lines(days_of_spread, counts_italy, col='red')
counts_italy
counts_italy*10
counts_italy[0]
counts_italy
counts_italy[5
]
counts_italy[5]
y_italy[5]
y_italy>0
y_italy[y_italy>0]
days_of_spread = c(0:80)
counts_italy <- exp(predict(f_world,list(day=days_of_spread)))
plot(days_of_spread,counts_italy, main="")
lines(days_of_spread, counts_italy, col='red')
